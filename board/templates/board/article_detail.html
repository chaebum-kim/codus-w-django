{% extends 'layout.html' %}
{% load static humanize %}

{% block content %}

    <div class="container">
        <ul>
            <li>{{ article.title }}</li>
            <li>{{ article.created_at }}</li>
            <li>{{ article.updated_at }}</li>
            <li>{{ article.content }}</li>
            <li>
                {% for tag in article.tag_set.all %}
                    #{{ tag }}
                {% endfor %}
            </li>
        </ul>
        
        {% if user.is_authenticated and article.author == user %}
            <div class="row">
                <div class="col-sm-3">
                    <a href="{% url 'board:article_edit' article.pk %}">
                        <button class="btn btn-dark btn-block">Edit</button>
                    </a>
                </div>
                <div class="col-sm-3">
                    <a href="{% url 'board:article_delete' article.pk %}">
                        <button class="btn btn-danger btn-block">Delete</button>
                    </a>
                </div>
            </div>
        {% endif %}
    </div>

    <div class="container">
        <form action="{% url 'board:comment_new' article.pk %}" method="post">
            <div class="row">
                {% csrf_token %}
                <div class="col-sm-9">
                    {{ comment_form.content }}
                </div>
                <div class="col-sm-3">
                    <button type="submit" class="btn btn-dark">Add comment</button>
                </div>
            </div>
        </form>
    </div>

    <div id="comment-set" class="container mt-3">
        {% for comment in comment_list %}
            <div data-comment-pk="{{ comment.pk }}"">
                {{ comment.author.username }}
                <span>{{ comment.content }}</span>
                {{ comment.created_at|naturaltime }}
                {% if comment.author == request.user %}
                    <a href="#">Edit</a>
                    <a href="#">Delete</a>
                {% endif %}
            </div>
        {% endfor %}
    </div>

{% endblock %}

{% block script %}
    <script src="{% static 'board/comment.js' %}"></script>
{% endblock %}